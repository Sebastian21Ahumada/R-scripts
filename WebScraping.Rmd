---
title: "WebScrapingBuscalibre"
author: "Sebastian Ahumada"
date: "2023-06-01"
output:
  html_document:
    toc: yes
    toc_depth: 3
    toc_float: yes
    collapsed: yes
    smooth_scroll: yes
    theme: journal
    highlighted: kate
    df_print: paged
    code_folding: show
  pdf_document:
    toc: yes
    toc_depth: '3'
---

# Objective

The objective is to perform a web scraping exercise using R tools such as rvest to generate a dataset, which will then be used to conduct a small analysis.

# The choosen website

The website chosen for web scraping is buscalibre.cl. Busca Libre is a Chilean-origin website with a presence in some other Spanish-speaking countries and the United States. They manage the sales of products from other sellers, but their main focus is on book sales. Busca Libre is quite similar to Amazon in its early days.

# Libraries
library(dplyr) <br>
library(RSelenium) <br>
library(rvest) <br>
library(tidyverse) <br>
library(DT) <br>
library(ggplot2) <br>
library(gridExtra) <br>

```{r, echo=FALSE, include = FALSE}
library(dplyr)
library(RSelenium)
library(rvest)
library(tidyverse)
library(DT)
library(ggplot2)
library(gridExtra)
```


# Data Collection Function

A function was created to extract data associated with a search term from buscalibre.cl. The data collected includes: “id_producto,” “titulo,” “autor,” “precio,” “nota,” “votaciones,” “link.”

## What the function does:
1. Opens a Mozilla web browser and navigates to buscalibre.cl.
2. Types the desired search term into the search bar.
3. Waits for the page to load.
4. Collects and normalizes the data for each item.
5. Checks if there are additional pages to browse; if so, it goes to the next page and returns to step 3.
6. Delivers a dataframe with the data related to the search.

```{r}
get_books <- function(busqueda,espera) {
  rD <- rsDriver(port= sample(7600)[1], browser=c("firefox"), chromever = NULL)
  remDr <- rD[["client"]]
  remDr$navigate("https://www.buscalibre.cl/")
  
  # Search for the input
  input_busqueda <- remDr$findElement(using = "css selector", "input[name='q']")
  input_busqueda$clearElement()
  input_busqueda$sendKeysToElement(list(busqueda))
  input_busqueda$sendKeysToElement(list(key = "enter"))
  Sys.sleep(10)
  
  books_df <- data.frame(
    id_producto = character(),
    titulo = character(),
    autor = character(),
    precio = numeric(),
    nota = numeric(),
    votaciones = numeric(),
    link = character(),
    stringsAsFactors = FALSE
  )
  
  # Navigate through the pages
  while (TRUE) {
    # Extract book information
    book_elements <- remDr$findElements(using = 'css', '.box-producto')
    for (book_element in book_elements) {
      book_html <- read_html(book_element$getElementAttribute('outerHTML')[[1]])
      id_producto <- book_element$getElementAttribute('data-id_producto')[[1]]
      titulo <- html_text(html_node(book_html, 'h3.nombre'))
      autor <- html_text(html_node(book_html, 'div.autor'))
      precio <- as.numeric(gsub("\\D", "", html_text(html_node(book_html, 'p.precio-ahora strong'))))
      nota_raw <- html_attr(html_node(book_html, '.box-stars span'), 'class')  # Extrae la nota del libro
      nota <- as.numeric(ifelse(nchar(gsub("\\D", "", nota_raw)) == 2, as.numeric(gsub("\\D", "", nota_raw))/10, gsub("\\D", "", nota_raw))) # Convert to numeric
      votaciones <- as.numeric(gsub("\\D", "", html_text(html_node(book_html, '.box-stars span.margin-left-5'))))
      link <- html_attr(html_node(book_html, 'a'), 'href')
      books_df <- rbind(books_df, data.frame(
        id_producto = id_producto,
        titulo = titulo,
        autor = autor,
        precio = precio,
        nota = nota,
        votaciones = votaciones,
        link = link,
        stringsAsFactors = FALSE
      ))
    }
    
    # Check if next page exists
    next_page_elements <- remDr$findElements(using = 'css', '.pagnNext')
    if (length(next_page_elements) == 0) {
      # There is no more pages, exit the loop
      break
    }
    
    # Navigate to the next page
    next_page_link <- next_page_elements[[1]]$getElementAttribute('href')[[1]]
    remDr$navigate(next_page_link)
    Sys.sleep(espera)  # Wait until page load
  }
  

  # Return dataframe
  return(books_df)
}
```


# Data Collection

The function is executed for the categories of Sociology, Computer Science, Science Fiction, and Graphic Novels, which we will now refer to as categories. Data was collected for these categories and saved in both versions with NA and without NA.

```{r}
Sociologia <- get_books("sociología",2)
```

```{r}
Informatica <- get_books("informática",2)
```


```{r}
CFiccion <- get_books("ciencia ficción",2)
```


```{r}
NGraficas <- get_books("Novelas gráficas",2)
```

```{r}
comunista <- get_books("comunista",2)
```

```{r}
nazismo <- get_books("nazismo",2)
```


```{r}
#Store datasets
NA_Sociologia <- Sociologia
NA_Informatica <- Informatica
NA_CFiccion <- CFiccion
NA_NGraficas <- NGraficas
NA_comunista <- comunista
NA_nazismo <- nazismo
```


# Dataset

Once the information is collected by category, each dataset is merged into a single large dataset. To do this, a new column named "category" is added to each dataset.

```{r}
CFiccion <- CFiccion %>% mutate(categoria = "Ciencia Ficción")
CFiccion <- CFiccion %>% mutate(categoria_mayor = "Recreación")
comunista <- comunista %>% mutate(categoria = "Política")
comunista <- comunista %>% mutate(categoria_mayor = "Política")
nazismo <- nazismo %>% mutate(categoria = "Política")
nazismo <- nazismo %>% mutate(categoria_mayor = "Política")
Informatica <- Informatica %>% mutate(categoria = "Informática")
Informatica <- Informatica %>% mutate(categoria_mayor = "Técnico")
NGraficas <- NGraficas %>% mutate(categoria = "Novelas Gráficas")
NGraficas <- NGraficas %>% mutate(categoria_mayor = "Recreación")
Sociologia <- Sociologia %>% mutate(categoria = "Sociología")
Sociologia <- Sociologia %>% mutate(categoria_mayor = "Técnico")
```

Join every dataset into one:
```{r}
df <- bind_rows(CFiccion, comunista, nazismo, Informatica, NGraficas, Sociologia)
```

```{r}
df
```


## Dataset Analysis 
### Data Exploration

Get a quick overview of the main descriptive statistics of the data, including the mean, median, range, standard deviation, and the minimum and maximum values. Also, count the number of missing values in each variable.

```{r}
dim(df)
```

```{r describing_dataet, echo=FALSE}
summary_data <- summary(df)
summary_data
```


### Null Value Analysis
Review the quality of the data. Check how many null values are present in the entire dataset and specifically in the columns we will use.

```{r na, echo = TRUE}
sum(is.na(df)) ## Display How many na are in the whole dataset

# Review how many NA the interested columns have
sum(is.na(df$titulo))
sum(is.na(df$precio))
sum(is.na(df$votaciones))
```

As can be seen, out of the 3,610 records we have, only 285 books have ratings. This is logical, as most people do not usually leave comments or opinions on the books they purchase.

# Hypothesis 1

**People in Chile are more interested in recreational books**

For this hypothesis, we will only use the categories described earlier. We want to use this test dataset to pave the way for a more extensive analysis.

The categories have been classified as follows:

- Technical Reading: Computer Science and Sociology
- Recreational Reading: Science Fiction and Graphic Novels
- Politics: Communism and Nazism

Additionally, the hypothesis will be tested using 3 basic metrics:

- Availability: Number of copies available for sale by category.
- Rating: Ratings assigned to each book by category.
- Number of Opinions/Ratings: Number of reviews made in each category.

## Offers

```{r}
conteo_data <- df %>%
  group_by(categoria_mayor) %>%
  summarize(conteo = n())

conteo_data <- conteo_data %>%
  mutate(porcentaje = (conteo / sum(conteo)) * 100)

# Create pie chart
ggplot(conteo_data, aes(x = "", y = porcentaje, fill = categoria_mayor)) +
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start = 0) +
  labs(x = "", y = "", fill = "Categoría mayor") +
  ggtitle("Percentage of books for sale per Category") +
  theme_minimal() +
  theme(legend.position = "right") + 
  geom_text(aes(label = paste0(categoria_mayor, ": ", round(porcentaje, 1), "%")), position = position_stack(vjust = 0.5))
```

```{r}
count_data <- df %>%
  group_by(categoria_mayor,categoria) %>%
  summarize(count = n()) %>%
  arrange(desc(count))  # Order desc

# Create barchart 
ggplot(count_data, aes(x = reorder(categoria, -count), y = count)) +
  geom_bar(stat = "identity", aes(fill = categoria_mayor)) +
  labs(x = "Categoría", y = "Total de Libros") +
  labs(title = "Total books for sale per Category") +
  scale_fill_discrete()
```



## Calification

```{r}
datos <- df[!is.na(df$nota), ]

ggplot(datos, aes(x = categoria, y = nota)) +
  geom_boxplot(fill = "#4C72B0", color = "#1F3552", alpha = 0.8) +  
  geom_jitter(width = 0.2, alpha = 0.6, color = "#D2D3D4") +  
  labs(x = "Category", y = "Calification") +
  ggtitle("Distribution of calification per Category") +
  theme_minimal() +
  theme(plot.title = element_text(size = 14, face = "bold"),
        axis.text = element_text(size = 12),
        axis.title = element_text(size = 12, face = "bold"))
```


```{r}
datos <- df[!is.na(df$nota), ]

ggplot(datos, aes(x = categoria_mayor, y = nota)) +
  geom_boxplot(fill = "#4C72B0", color = "#1F3552", alpha = 0.8) +  
  geom_jitter(width = 0.2, alpha = 0.6, color = "#D2D3D4") +  
  labs(x = "Category", y = "Calification") +
  ggtitle("Distribution of califications per Category") +
  theme_minimal() +
  theme(plot.title = element_text(size = 14, face = "bold"),
        axis.text = element_text(size = 12),
        axis.title = element_text(size = 12, face = "bold"))
```


## Reviews

```{r}
df_group <- df %>%
  group_by(categoria_mayor) %>%
  summarize(total_libros = n(),
            libros_con_votaciones = sum(!is.na(votaciones)),
            suma_votaciones = sum(votaciones, na.rm = TRUE)) %>%
  mutate(libros_sin_votaciones = total_libros - libros_con_votaciones)


# Combine quantity of books in one column 
df_group <- df_group %>%
  tidyr::gather(key = "tipo", value = "cantidad", libros_con_votaciones, libros_sin_votaciones)

# Calculate percentages
df_group <- df_group %>%
  group_by(categoria_mayor) %>%
  mutate(porcentaje = cantidad / sum(cantidad) * 100)

# Order category desc 
df_group$categoria_mayor <- reorder(df_group$categoria_mayor, -df_group$cantidad, sum)

# Create stacked bar chart 
ggplot(df_group, aes(x = categoria_mayor, y = cantidad, fill = tipo)) +
  geom_col(position = "stack", color = "white", alpha = 0.8) +
  geom_text(aes(label = paste0(round(porcentaje, 1), "%")), position = position_stack(vjust = 0.5), color = "white", size = 3) +
  geom_text(aes(label = paste0(round(porcentaje, 1), "%"), y = cantidad + 0.5), position = position_stack(vjust = 0.5), color = "black", size = 3) +
  labs(x = "Category", y = "Number of books") +
  ggtitle("Number of books with and without reviews per Category") +
  scale_fill_manual(values = c("#4C72B0", "#DD8452"),
                    labels = c("Con votaciones", "Sin votaciones")) +
  theme_minimal()
```

## Summary

In summary, from the previous analysis:

1. The highest number of books offered on the website (when comparing only the described categories) are technical books (approximately 71%).

2. Ratings given by readers are quite similar, with nearly all being positive (5 stars).

3. Recreational Reading is the category with the most books having reviews and also has the highest number of reviews per book offered.

In conclusion, based on the above observations, we cannot definitively conclude that Recreational Reading is the most read category in Chile. However, it is evident that people tend to provide much more feedback on these books compared to those in the other categories analyzed.


# Hypothesis 2

**Do more expensive books have better ratings?**

For this hypothesis, we will only use books that have at least one rating. Therefore, we will filter the previously used dataset accordingly:

```{r}
df_filter <- df %>% filter(!is.na(nota))

df_filter_tecnico <- df_filter %>% filter(categoria_mayor == "Técnico")
df_filter_recreativo <- df_filter %>% filter(categoria_mayor == "Recreación")
df_filter_politica_mayor <- df_filter %>% filter(categoria_mayor == "Política")


df_filter_sociologia <- df_filter %>% filter(categoria == "Sociología")
df_filter_informatica <- df_filter %>% filter(categoria == "Informática")
df_filter_cf <- df_filter %>% filter(categoria == "Ciencia Ficción")
df_filter_politica <- df_filter %>% filter(categoria == "Política")
df_filter_ngraf <- df_filter %>% filter(categoria == "Novelas Gráficas")
```

Primero analizamos la relación a nivel general, es decir utilizando todos los libros del dataset.

```{r}
modelo <- lm(precio ~ nota, data = df_filter)

# Calculate R square
r_cuadrado <- cor(df_filter$nota, df_filter$precio)

# Scatter plot with regresion line 
ggplot(df_filter, aes(y = nota, x = precio)) +
  geom_point(size = 3, color = "#4C72B0") +
  geom_smooth(method = "lm", se = FALSE, color = "#DD8452", size = 1, alpha = 0.2) +
  labs(y = "Calification", x = "Price", title = "Correlation between Calification and Price") +
  theme_minimal() +
  theme(plot.title = element_text(size = 16, face = "bold"),
        axis.title = element_text(size = 12),
        axis.text = element_text(size = 10),
        legend.position = "none") +
  annotate("text", y = min(df_filter$nota)+3.8, x = max(df_filter$precio)-15000, 
           label = paste0("R cuadrado: ", round(r_cuadrado, 2)),
           hjust = 0, vjust = 1, size = 4, fontface = "bold", color = "#DD8452")
```
Then, the analysis is conducted at the "categoria mayor" (broader category) level to identify whether there is any relationship between price and rating at this level.


```{r}

r_cuadrado <- cor(df_filter_tecnico$nota, df_filter_tecnico$precio)

plot_tecnico <- ggplot(df_filter_tecnico, aes(x = precio, y = nota)) +
  geom_point() +
  ggtitle("Técnico") +
  xlab("Price") +
  ylab("Calification") +
  theme_minimal() +
  theme(plot.title = element_text(size = 16, face = "bold"),
        axis.title = element_text(size = 12),
        axis.text = element_text(size = 10),
        legend.position = "none") +
  annotate("text", y = min(df_filter_tecnico$nota) + 0.5, x = min(df_filter_tecnico$precio) + 1, 
           label = paste0("R square: ", round(r_cuadrado, 2)),
           hjust = 0, vjust = 1, size = 4, fontface = "bold", color = "#DD8452")

r_cuadrado <- cor(df_filter_recreativo$nota, df_filter_recreativo$precio)

plot_recreativo <- ggplot(df_filter_recreativo, aes(x = precio, y = nota)) +
  geom_point() +
  ggtitle("Recreativo") +
  xlab("Price") +
  ylab("Calification") +
  theme_minimal() +
  theme(plot.title = element_text(size = 16, face = "bold"),
        axis.title = element_text(size = 12),
        axis.text = element_text(size = 10),
        legend.position = "none") +
  scale_y_continuous(limits = c(1, 5)) +
  annotate("text", y = min(df_filter_recreativo$nota)+0.5, x = min(df_filter_recreativo$precio) + 1, 
           label = paste0("R square: ", round(r_cuadrado, 2)),
           hjust = 0, vjust = 1, size = 4, fontface = "bold", color = "#DD8452")

r_cuadrado <- cor(df_filter_politica_mayor$nota, df_filter_politica_mayor$precio)

plot_pol_mayor <- ggplot(df_filter_politica_mayor, aes(x = precio, y = nota)) +
  geom_point() +
  ggtitle("Política") +
  xlab("Price") +
  ylab("Calification") +
  theme_minimal() +
  theme(plot.title = element_text(size = 16, face = "bold"),
        axis.title = element_text(size = 12),
        axis.text = element_text(size = 10),
        legend.position = "none") +
  annotate("text", y = min(df_filter_politica_mayor$nota)+0.5, x = min(df_filter_politica_mayor$precio)+1, 
           label = paste0("R square: ", round(r_cuadrado, 2)),
           hjust = 0, vjust = 1, size = 4, fontface = "bold", color = "#DD8452")

grid.arrange(plot_tecnico,plot_recreativo, plot_pol_mayor, ncol = 2)
```

Finally, we examine whether there are any relationships between rating and price at the individual category level.

```{r}

r_cuadrado <- cor(df_filter_sociologia$nota, df_filter_sociologia$precio)

plot_Sociologia <- ggplot(df_filter_sociologia, aes(x = precio, y = nota)) +
  geom_point() +
  ggtitle("Sociología") +
  xlab("Price") +
  ylab("Calification") +
  theme_minimal() +
  theme(plot.title = element_text(size = 16, face = "bold"),
        axis.title = element_text(size = 12),
        axis.text = element_text(size = 10),
        legend.position = "none") +
  annotate("text", y = min(df_filter_sociologia$nota)+0.5, x = min(df_filter_sociologia$precio)+1, 
           label = paste0("R square: ", round(r_cuadrado, 2)),
           hjust = 0, vjust = 1, size = 4, fontface = "bold", color = "#DD8452")


r_cuadrado <- cor(df_filter_informatica$nota, df_filter_informatica$precio)

plot_Informatica <- ggplot(df_filter_informatica, aes(x = precio, y = nota)) +
  geom_point() +
  ggtitle("Informática") +
  xlab("Price") +
  ylab("Calification") +
  theme_minimal() +
  theme(plot.title = element_text(size = 16, face = "bold"),
        axis.title = element_text(size = 12),
        axis.text = element_text(size = 10),
        legend.position = "none") +
  scale_y_continuous(limits = c(1, 5)) +
  annotate("text", y = min(df_filter_informatica$nota)+0.5, x = min(df_filter_informatica$precio)+1, 
           label = paste0("R square: ", round(r_cuadrado, 2)),
           hjust = 0, vjust = 1, size = 4, fontface = "bold", color = "#DD8452")

r_cuadrado <- cor(df_filter_cf$nota, df_filter_cf$precio)

plot_CFiccion <- ggplot(df_filter_cf, aes(x = precio, y = nota)) +
  geom_point() +
  ggtitle("Ciencia Ficción") +
  xlab("Price") +
  ylab("Calification") +
  theme_minimal() +
  theme(plot.title = element_text(size = 16, face = "bold"),
        axis.title = element_text(size = 12),
        axis.text = element_text(size = 10),
        legend.position = "none") +
  scale_y_continuous(limits = c(1, 5)) +
  annotate("text", y = min(df_filter_cf$nota)+0.5, x = min(df_filter_cf$precio), 
           label = paste0("R square: ", round(r_cuadrado, 2)),
           hjust = 0, vjust = 1, size = 4, fontface = "bold", color = "#DD8452")

modelo <- lm(precio ~ nota, data = df_filter_politica)
r_cuadrado <- summary(modelo)$r.squared


r_cuadrado <- cor(df_filter_politica$nota, df_filter_politica$precio)

plot_politica <- ggplot(df_filter_politica, aes(x = precio, y = nota)) +
  geom_point() +
  ggtitle("Política") +
  xlab("Price") +
  ylab("Calification") +
  theme_minimal() +
  theme(plot.title = element_text(size = 16, face = "bold"),
        axis.title = element_text(size = 12),
        axis.text = element_text(size = 10),
        legend.position = "none") +
  annotate("text", y = min(df_filter_politica$nota)+0.5, x = min(df_filter_politica$precio)+1, 
           label = paste0("R square: ", round(r_cuadrado, 2)),
           hjust = 0, vjust = 1, size = 4, fontface = "bold", color = "#DD8452")

modelo <- lm(nota ~ precio, data = df_filter_ngraf)
r_cuadrado <- summary(modelo)$r.squared


r_cuadrado <- cor(df_filter_ngraf$nota, df_filter_ngraf$precio)

plot_NGraficas <- ggplot(df_filter_ngraf, aes(x = precio, y = nota)) +
  geom_point() +
  ggtitle("Novelas Gráficas") +
  xlab("Price") +
  ylab("Calification") +
  theme_minimal() +
  theme(plot.title = element_text(size = 16, face = "bold"),
        axis.title = element_text(size = 12),
        axis.text = element_text(size = 10),
        legend.position = "none") +
  scale_y_continuous(limits = c(1, 5)) +
  annotate("text", y = min(df_filter_ngraf$nota)+0.5, x = min(df_filter_ngraf$precio)+1, 
           label = paste0("R square: ", round(r_cuadrado, 2)),
           hjust = 0, vjust = 1, size = 4, fontface = "bold", color = "#DD8452")

# Join 4 charts in one single visualization
grid.arrange(plot_Sociologia, plot_Informatica, plot_CFiccion, plot_NGraficas,plot_politica, ncol = 2)
```

The result indicates that there is no correlation in most categories, except in Computer Science, where the correlation is -0.74, a strong negative correlation. This implies that as the rating increases, the price of the book tends to decrease. The case of Computer Science appears suspicious, so to check if this is consistent, we recalculated the correlation after removing the outliers.

The interquartile range (IQR) was used to identify and remove outliers in the categories.

```{r}
#Without outlayer

# Para Sociologia
# Calculate IQR for Sociologia Price
IQR_precio_Sociologia <- IQR(df_filter_sociologia$precio)
# Delete outliers based on price ("Precio")
Sociologia_sin_outliers <- df_filter_sociologia[!(df_filter_sociologia$precio < quantile(df_filter_sociologia$precio, 0.25) - 1.5 * IQR_precio_Sociologia |
                                          df_filter_sociologia$precio > quantile(df_filter_sociologia$precio, 0.75) + 1.5 * IQR_precio_Sociologia),]

# Calculate correlation without outliers
correlacion_Sociologia_sin_outliers <- cor(Sociologia_sin_outliers$nota, Sociologia_sin_outliers$precio)


# Para Informatica
IQR_precio_Informatica <- IQR(df_filter_informatica$precio)
Informatica_sin_outliers <- df_filter_informatica[!(df_filter_informatica$precio < quantile(df_filter_informatica$precio, 0.25) - 1.5 * IQR_precio_Informatica |
                                            df_filter_informatica$precio > quantile(df_filter_informatica$precio, 0.75) + 1.5 * IQR_precio_Informatica),]
correlacion_Informatica_sin_outliers <- cor(Informatica_sin_outliers$nota, Informatica_sin_outliers$precio)

# Para CFiccion
IQR_precio_CFiccion <- IQR(df_filter_cf$precio)
CFiccion_sin_outliers <- df_filter_cf[!(df_filter_cf$precio < quantile(df_filter_cf$precio, 0.25) - 1.5 * IQR_precio_CFiccion |
                                      df_filter_cf$precio > quantile(df_filter_cf$precio, 0.75) + 1.5 * IQR_precio_CFiccion),]
correlacion_CFiccion_sin_outliers <- cor(CFiccion_sin_outliers$nota, CFiccion_sin_outliers$precio)

# Para Politica
IQR_precio_politica <- IQR(df_filter_politica$precio)
politica_sin_outliers <- df_filter_politica[!(df_filter_politica$precio < quantile(df_filter_politica$precio, 0.25) - 1.5 * IQR_precio_politica |
                                        df_filter_politica$precio > quantile(df_filter_politica$precio, 0.75) + 1.5 * IQR_precio_politica),]
correlacion_politica_sin_outliers <- cor(politica_sin_outliers$nota, politica_sin_outliers$precio)


# Para NGraficas
IQR_precio_NGraficas <- IQR(df_filter_ngraf$precio)
NGraficas_sin_outliers <- df_filter_ngraf[!(df_filter_ngraf$precio < quantile(df_filter_ngraf$precio, 0.25) - 1.5 * IQR_precio_NGraficas |
                                        df_filter_ngraf$precio > quantile(df_filter_ngraf$precio, 0.75) + 1.5 * IQR_precio_NGraficas),]
correlacion_NGraficas_sin_outliers <- cor(NGraficas_sin_outliers$nota, NGraficas_sin_outliers$precio)


correlaciones_df_sout <- data.frame(
  Categoria = c("Sociología", "Informática", "Ciencia Ficción","Politica" ,"Novela Gráfica"),
  Correlacion = c(correlacion_Sociologia_sin_outliers, correlacion_Informatica_sin_outliers, correlacion_CFiccion_sin_outliers,correlacion_politica_sin_outliers, correlacion_NGraficas_sin_outliers)
)

print(correlaciones_df_sout)
```
The correlation without outliers changes the Computer Science category to a moderate correlation, while the rest of the categories remain unchanged, showing no correlation between rating and price.

As observed in the previous analyses, it is concluded that there is no linear correlation between the price and rating of a book. Therefore, our hypothesis is false: more expensive books do not have better ratings.

